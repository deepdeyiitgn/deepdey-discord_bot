<!-- Save as 404.html ‚Äî full single-file, offline-friendly interactive 404 page -->
<!--
  404 Offline Interactive Page
  - Self-contained (no external fonts or images)
  - Animations, particle background, glitch 404 headline
  - Home and Portfolio buttons (use your domains)
  - Three offline games: Snake, Tic-Tac-Toe, Memory Match (saved high scores in localStorage)
  - Typing-banner replicates your "typing SVG" lines locally
  - Footer includes your provided credit snippet
  Author: ChatGPT for Deep Dey ‚Äî edit freely
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" type="image/png" href="https://www.deepdeyiitk.com/web/image/website/1/favicon?unique=e5fe8cd">
<title>404 ‚Äî Deep Dey</title>
  <script src="script.js" defer></script>

   <!-- Open Graph Meta Tags -->
<meta property="og:type" content="website"/>
<meta property="og:title" content="StudyBot ‚Äî Your Study Companion ‚Ä¢ Deep Dey"/>
<meta property="og:site_name" content="Deep Dey - The FUTURE IITIAN üéØ"/>
<meta property="og:url" content="https://bots.deepdeyiitk.com/404.html"/>
<meta property="og:image" content="https://i.postimg.cc/YSV9JqBD/Neon-Green-Circle-Frame-Fitness-You-Tube-Profile-Picturedurga-puja.png"/>
<meta property="og:description" content="üìò StudyBot ‚Äî the AI-powered Discord companion built by Deep Dey to boost discipline, focus, and consistency for JEE 2027 aspirants. Track uptime, check productivity, and stay accountable 24√ó7. Made with ü©∑ and vision for IIT Kanpur."/>

 <div>
  <!-- Diwali Popup HTML, CSS, and JS merged -->
<style>
.diwali-popup-content {
  background: linear-gradient(135deg, #2c1810 0%, #1a0f0a 100%);
  padding: 40px;
  border-radius: 20px;
  position: relative;
  max-width: 500px;
  text-align: center;
  border: 2px solid #ff9933;
  box-shadow: 0 0 50px rgba(255, 153, 51, 0.3), inset 0 0 30px rgba(255, 153, 51, 0.2);
  animation: glowPulse 2s infinite alternate;
}
@keyframes glowPulse {
  0% { box-shadow: 0 0 50px rgba(255, 153, 51, 0.3), inset 0 0 30px rgba(255, 153, 51, 0.2); }
  100% { box-shadow: 0 0 70px rgba(255, 153, 51, 0.4), inset 0 0 40px rgba(255, 153, 51, 0.3); }
}
.close-diwali-popup {
  position: absolute;
  top: 15px;
  right: 15px;
  background: none;
  border: none;
  color: #ff9933;
  font-size: 24px;
  cursor: pointer;
  transition: all 0.3s ease;
  z-index: 1;
}
.close-diwali-popup:hover {
  transform: scale(1.2);
  color: #ffb366;
}
.diwali-title {
  color: #ff9933;
  font-size: 36px;
  margin: 20px 0;
  text-shadow: 0 0 10px rgba(255, 153, 51, 0.5);
  font-family: 'Poppins', sans-serif;
  animation: titleGlow 2s infinite alternate;
}
@keyframes titleGlow {
  0% { text-shadow: 0 0 10px rgba(255, 153, 51, 0.5); }
  100% { text-shadow: 0 0 20px rgba(255, 153, 51, 0.8); }
}
.diwali-message {
  color: #ffb366;
  font-size: 18px;
  margin: 20px 0;
  line-height: 1.6;
  font-family: 'Poppins', sans-serif;
}
.diya-container {
  position: relative;
  width: 100px;
  height: 100px;
  margin: 0 auto;
}
.flame {
  position: absolute;
  top: 25%;
  left: 50%;
  transform: translateX(-50%);
  width: 20px;
  height: 30px;
  background: linear-gradient(to bottom,rgba(255,255,255,0.8) 0%,rgba(255,204,0,0.8) 60%,rgba(255,153,51,0.4) 100%);
  border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
  animation: flicker 1s infinite alternate;
  filter: blur(2px);
}
@keyframes flicker {
  0%, 100% { transform: translateX(-50%) scale(1); opacity: 1; }
  50% { transform: translateX(-50%) scale(0.8); opacity: 0.8; }
}
.diwali-footer {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  margin-top: 20px;
  color: #ffb366;
  font-family: 'Poppins', sans-serif;
}
.diwali-logo {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  animation: logoSpin 4s infinite alternate;
}
@keyframes logoSpin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
/* Lighting wire */
#lighting-wire svg circle {
  filter: drop-shadow(0 0 8px #fff) brightness(1.2);
  animation: lightBlink 1.5s infinite alternate;
}
@keyframes lightBlink {
  0% { opacity: 1; }
  100% { opacity: 0.7; }
}
/* Skyshot and lantern styles */
.skyshot {
  transition: box-shadow 0.2s;
}
.blast-particle {
  box-shadow: 0 0 12px #FFD700;
}
.lantern-real {
  pointer-events: none;
}
</style>
<div class="diwali-popup-content" style="position:relative;">
  <button class="close-diwali-popup">&times;</button>
  <!-- Festive Lighting Wire -->
  <div id="lighting-wire" style="position:absolute;top:0;left:0;width:100%;height:48px;pointer-events:none;z-index:10;">
    <svg width="100%" height="48" viewBox="0 0 500 48" style="overflow:visible;">
      <path d="M10,20 Q250,-10 490,20" stroke="#8B4513" stroke-width="4" fill="none"/>
      <g>
        <circle cx="40" cy="16" r="8" fill="#FFD700"/>
        <circle cx="90" cy="12" r="7" fill="#FF9933"/>
        <circle cx="140" cy="18" r="8" fill="#4CAF50"/>
        <circle cx="190" cy="10" r="7" fill="#E91E63"/>
        <circle cx="240" cy="14" r="8" fill="#FFC107"/>
        <circle cx="290" cy="12" r="7" fill="#FF0000"/>
        <circle cx="340" cy="18" r="8" fill="#FFD700"/>
        <circle cx="390" cy="10" r="7" fill="#4CAF50"/>
        <circle cx="440" cy="16" r="8" fill="#FF9933"/>
      </g>
    </svg>
  </div>
  <div class="diya-container">
    <svg viewBox="0 0 100 100" width="100" height="100">
      <path d="M50 70 C20 70 20 40 50 40 C80 40 80 70 50 70" fill="#CD853F"/>
      <ellipse cx="50" cy="40" rx="15" ry="5" fill="#8B4513"/>
    </svg>
    <div class="flame"></div>
  </div>
  <h2 class="diwali-title">Happy Diwali! ü™î</h2>
  <div class="diwali-decoration">
    <svg viewBox="0 0 100 20" width="100%" height="40">
      <pattern id="rangoli" patternUnits="userSpaceOnUse" width="20" height="20">
        <circle cx="10" cy="10" r="3" fill="#ff9933"/>
        <circle cx="10" cy="10" r="6" fill="none" stroke="#ff9933" stroke-width="0.5"/>
      </pattern>
      <rect width="100" height="20" fill="url(#rangoli)"/>
    </svg>
  </div>
  <p class="diwali-message">
    May the festival of lights brighten your studies and illuminate your path to success! <br><br>
    Study with joy, learn with passion! ‚ú®
  </p>
  <div id="diwali-timer" style="font-size:1.2rem;color:#FFD700;margin:12px 0;"></div>
  <div class="diwali-footer">
    <img src="https://i.postimg.cc/MHYsLfPz/Neon-Green-Circle-Frame-Fitness-You-Tube-Profile-Picturedurga-puja.png" alt="StudyBot Logo" class="diwali-logo">
    <span>~ StudyBot Team</span>
  </div>
  <div id="popup-skyshot" style="position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:100;"></div>
  <div id="popup-lantern" style="position:absolute;left:0;width:100%;height:100%;top:0;pointer-events:none;z-index:101;"></div>
</div>
<script>
// Diwali dates (2025-2045)
const diwaliDates = [
  '2025-10-20', '2026-11-08', '2027-10-29', '2028-10-17', '2029-11-05',
  '2030-10-26', '2031-11-14', '2032-11-02', '2033-10-22', '2034-11-10',
  '2035-10-30', '2036-10-19', '2037-11-07', '2038-10-27', '2039-10-17',
  '2040-11-04', '2041-10-25', '2042-11-12', '2043-11-01', '2044-10-20', '2045-11-08'
];
function getNextDiwali(now) {
  for (let i = 0; i < diwaliDates.length; i++) {
    const d = new Date(diwaliDates[i] + 'T00:00:00');
    if (d > now) return {date: d, idx: i};
  }
  return null;
}
let timerState = 'diwali';
let timerIdx = null;
let timerEnd = null;
const timerEl = document.getElementById('diwali-timer');
function updateTimer() {
  const now = new Date();
  let next = getNextDiwali(now);
  if (!next) {
    timerEl.textContent = 'No upcoming Diwali dates.';
    return;
  }
  timerIdx = next.idx;
  let diwaliDate = next.date;
  let diff = diwaliDate - now;
  let days = Math.floor(diff / (1000*60*60*24));
  let hours = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
  let mins = Math.floor((diff % (1000*60*60)) / (1000*60));
  let secs = Math.floor((diff % (1000*60)) / 1000);
  if (diff > 0 && diff < 1000*60*60*24*31) {
    timerState = 'diwali';
    timerEl.textContent = `Diwali will start in: ${days}d ${hours}h ${mins}m ${secs}s`;
    timerEnd = diwaliDate;
  } else {
    timerState = 'upcoming';
    timerEl.textContent = `Upcoming Diwali will be: ${diwaliDate.toDateString()}`;
    timerEnd = diwaliDate;
  }
}
updateTimer();
let timerInterval = setInterval(() => {
  updateTimer();
  if (timerState === 'diwali' && timerEnd) {
    const now = new Date();
    if (now >= timerEnd) {
      clearInterval(timerInterval);
      timerEl.textContent = 'Diwali is here! üéâ';
      setTimeout(() => {
        setTimeout(() => {
          timerIdx = timerIdx + 1;
          if (timerIdx < diwaliDates.length) {
            timerState = 'upcoming';
            timerEnd = new Date(diwaliDates[timerIdx] + 'T00:00:00');
            timerEl.textContent = `Upcoming Diwali will be: ${timerEnd.toDateString()}`;
            timerInterval = setInterval(updateTimer, 1000);
          } else {
            timerEl.textContent = 'No upcoming Diwali dates.';
          }
        }, 3*24*60*60*1000);
      }, 2000);
    }
  }
}, 1000);
// Skyshot and lantern animation for popup
function launchSkyshot(target, width, height) {
  const shot = document.createElement('div');
  shot.className = 'skyshot';
  const x = Math.random() * width * 0.8 + width * 0.1;
  shot.style.left = x + 'px';
  shot.style.bottom = '0px';
  shot.style.position = 'absolute';
  shot.style.width = '6px';
  shot.style.height = '60px';
  shot.style.background = 'linear-gradient(to top, #FFD700 0%, #ff9933 100%)';
  shot.style.borderRadius = '3px';
  shot.style.opacity = '0.8';
  shot.style.zIndex = '9999';
  target.appendChild(shot);
  let t = 0;
  const duration = 60 + Math.random()*40;
  const interval = setInterval(() => {
    t += 4;
    shot.style.bottom = t + 'px';
    if (t > height * (0.5 + Math.random()*0.3)) {
      clearInterval(interval);
      createBlast(x, t, target);
      shot.remove();
    }
  }, 12);
}
function createBlast(x, y, target) {
  for (let i = 0; i < 18; i++) {
    const p = document.createElement('div');
    p.className = 'blast-particle';
    p.style.position = 'absolute';
    p.style.left = x + 'px';
    p.style.bottom = y + 'px';
    p.style.width = '8px';
    p.style.height = '8px';
    p.style.borderRadius = '50%';
    p.style.background = `hsl(${Math.random()*60+30},100%,60%)`;
    p.style.opacity = '0.9';
    p.style.zIndex = '9999';
    target.appendChild(p);
    const angle = (i/18)*2*Math.PI;
    const dist = 60 + Math.random()*40;
    let step = 0;
    const blastInterval = setInterval(() => {
      step += 1.5;
      p.style.left = (x + Math.cos(angle)*dist*step/20) + 'px';
      p.style.bottom = (y + Math.sin(angle)*dist*step/20) + 'px';
      p.style.opacity = (1-step/20).toFixed(2);
      if (step > 20) {
        clearInterval(blastInterval);
        p.remove();
      }
    }, 18);
  }
}
function launchLantern(target, width, height) {
  const lantern = document.createElement('div');
  lantern.className = 'lantern-real';
  lantern.style.position = 'absolute';
  lantern.style.left = (Math.random()*80+10)*(width/100)+'px';
  lantern.style.bottom = '0px';
  lantern.style.width = '32px';
  lantern.style.height = '48px';
  lantern.style.zIndex = '9999';
  lantern.innerHTML = `<svg width="32" height="48" viewBox="0 0 32 48"><ellipse cx="16" cy="24" rx="14" ry="20" fill="url(#lg)"/><defs><linearGradient id="lg" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFD700"/><stop offset="100%" stop-color="#ff9933"/></linearGradient></defs><ellipse cx="16" cy="40" rx="6" ry="4" fill="#fff" opacity="0.7"/><rect x="14" y="44" width="4" height="4" rx="2" fill="#FFD700"/></svg>`;
  target.appendChild(lantern);
  let t = 0;
  const floatHeight = height * (0.7 + Math.random()*0.2);
  const interval = setInterval(() => {
    t += 2.5;
    lantern.style.bottom = t + 'px';
    lantern.style.opacity = (1-t/floatHeight).toFixed(2);
    if (t > floatHeight) {
      clearInterval(interval);
      lantern.remove();
    }
  }, 22);
}
let popupSkyshotInterval = setInterval(() => launchSkyshot(document.getElementById('popup-skyshot'), document.getElementById('popup-skyshot').offsetWidth, document.getElementById('popup-skyshot').offsetHeight), 1800);
let popupLanternInterval = setInterval(() => launchLantern(document.getElementById('popup-lantern'), document.getElementById('popup-lantern').offsetWidth, document.getElementById('popup-lantern').offsetHeight), 2200);
document.querySelector('.close-diwali-popup').addEventListener('click', function() {
  clearInterval(timerInterval);
  clearInterval(popupSkyshotInterval);
  clearInterval(popupLanternInterval);
  document.querySelector('.diwali-popup-content').remove();
});
</script>
</div> 
<div> 
  <!-- Navaratri & Dussehra Popup | Dates: 22 Sept 2025 ‚Äì 2 Oct 2025 ~04 oct 2025  14:02:10 pm-->


  <div id="festive-popup-container">
  <div id="festive-popup-overlay">
    <div id="festive-popup">
      <button id="close-popup-btn" title="Close">&times;</button>
      <h2 id="popup-title"></h2>
      <p id="popup-message"></p>
      <div id="countdown-timer"></div>
      <div id="stopwatch" style="display:none;"></div>
      <div class="popup-buttons">
        <button class="popup-btn" id="generate-flowers-btn">üå∏ Shower Flowers</button>
        <button class="popup-btn" id="get-blessed-btn">üôè Receive Blessings</button>
      </div>
    </div>
  </div>

  <div id="blessing-popup-overlay">
    <div id="blessing-popup">
      <h3 id="blessing-title"></h3>
      <p id="blessing-message"></p>
      <button class="popup-btn" id="close-blessing-btn">Close</button>
    </div>
  </div>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Lobster&family=Poppins:wght@400;600&display=swap');

    #festive-popup-overlay, #blessing-popup-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.75);
      z-index: 99999; /* Highest z-index to stay on top */
      display: none;
      justify-content: center;
      align-items: center;
      padding: 15px;
      box-sizing: border-box;
    }

    #festive-popup, #blessing-popup {
      position: relative;
      background-size: cover;
      background-position: center;
      padding: 30px 40px;
      border-radius: 20px;
      text-align: center;
      color: white;
      font-family: 'Poppins', sans-serif;
      max-width: 95%;
      width: 600px;
      box-shadow: 0 10px 40px rgba(255,152,0,0.5);
      border: 2px solid #ff9800;
      animation: zoomIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      transform-origin: center;
    }
    
    #blessing-popup {
        background: #fff;
        color: #333;
    }

    @keyframes zoomIn {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }

    @keyframes zoomOut {
      from { opacity: 1; transform: scale(1); }
      to { opacity: 0; transform: scale(0.8); }
    }

    #festive-popup h2 {
      font-family: 'Lobster', cursive;
      font-size: clamp(2rem, 6vw, 2.8rem);
      margin-bottom: 15px;
      text-shadow: 3px 3px 10px rgba(0,0,0,0.8);
      color: #FFD700; /* Gold color */
    }

    #festive-popup p {
      font-size: clamp(1rem, 3vw, 1.2rem);
      margin-bottom: 20px;
      text-shadow: 2px 2px 8px rgba(0,0,0,0.8);
      line-height: 1.6;
    }

    #countdown-timer, #stopwatch {
      font-size: clamp(1.2rem, 4vw, 1.5rem);
      font-weight: 600;
      margin-top: 25px;
      background-color: rgba(0, 0, 0, 0.6);
      padding: 12px;
      border-radius: 10px;
      display: inline-block;
    }

    .popup-buttons {
      margin-top: 30px;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
    }

    .popup-btn {
      background: linear-gradient(45deg, #ff9800, #f57c00);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 50px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      text-transform: uppercase;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .popup-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }
    
    #blessing-popup h3 {
      font-family: 'Lobster', cursive;
      font-size: 2rem;
      color: #f57c00;
    }

    #blessing-popup p {
      font-size: 1.1rem;
      color: #555;
    }

    #close-popup-btn {
      position: absolute;
      top: 10px;
      right: 15px;
      background: transparent;
      border: none;
      color: white;
      font-size: 2.5rem;
      cursor: pointer;
      text-shadow: 2px 2px 5px rgba(0,0,0,0.8);
      line-height: 1;
    }

    .flower-petal {
      position: fixed; /* Use fixed to fall over the whole page */
      top: -20px;
      width: 15px;
      height: 15px;
      background-color: #ffeb3b;
      border-radius: 50% 0;
      animation: fall linear infinite;
      z-index: 100000;
    }

    @keyframes fall {
      to {
        transform: translateY(105vh) rotate(720deg);
        opacity: 0;
      }
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // --- Configuration ---
      const festiveData = {
        '2025-09-23': { day: 1, title: 'Happy Navaratri! Day 1', message: 'May the divine grace of Maa Shailaputri bring you unparalleled strength, peace, and prosperity. Wishing you a joyous start to Navaratri!', blessing: 'On Day 1, we worship Maa Shailaputri, the daughter of the Himalayas. She embodies purity and unwavering determination.', image: 'https://images.pexels.com/photos/17585093/pexels-photo-17585093/free-photo-of-a-statue-of-a-goddess-in-a-temple.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1' },
        '2025-09-24': { day: 2, title: 'Shubh Navaratri! Day 2', message: 'Let the blessings of Maa Brahmacharini guide your spirit towards devotion and inner calm. Have a spiritually uplifting day!', blessing: 'Maa Brahmacharini, worshipped on Day 2, represents asceticism and devotion. She grants her devotees wisdom and tranquility.', image: 'https://images.pexels.com/photos/17585093/pexels-photo-17585093/free-photo-of-a-statue-of-a-goddess-in-a-temple.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1' },
        '2025-09-25': { day: 3, title: 'Joyous Navaratri! Day 3', message: 'May the radiant glow of Maa Chandraghanta fill your life with courage, grace, and serenity. Wishing you a blessed day!', blessing: 'Day 3 is for Maa Chandraghanta. Adorned with a crescent moon, she is the symbol of bravery and dispels all evils.', image: 'https://images.pexels.com/photos/17585093/pexels-photo-17585093/free-photo-of-a-statue-of-a-goddess-in-a-temple.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1' },
        '2025-09-26': { day: 4, title: 'Happy Navaratri! Day 4', message: 'May the creative energy of Maa Kushmanda bless your world with happiness, health, and abundance. Stay joyful!', blessing: 'Maa Kushmanda, worshipped on Day 4, is believed to be the creator of the universe. She bestows good health and wealth.', image: 'https://images.pexels.com/photos/17585093/pexels-photo-17585093/free-photo-of-a-statue-of-a-goddess-in-a-temple.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1' },
        '2025-09-27': { day: 5, title: 'Blessed Navaratri! Day 5', message: 'Feel the warmth of Maa Skandamata\'s love. May she shower you and your loved ones with boundless affection and care.', blessing: 'Day 5 honours Maa Skandamata, the mother of Lord Kartikeya. She symbolizes the pure, selfless love of a mother.', image: 'https://images.pexels.com/photos/17585093/pexels-photo-17585093/free-photo-of-a-statue-of-a-goddess-in-a-temple.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1' },
        '2025-09-28': { day: 6, title: 'Divine Navaratri! Day 6', message: 'May the fierce and benevolent Maa Katyayani empower you to conquer all challenges with courage and conviction. Jai Mata Di!', blessing: 'Maa Katyayani, worshipped on Day 6, is the warrior goddess who grants strength to overcome life\'s obstacles.', image: 'https://images.pexels.com/photos/17585093/pexels-photo-17585093/free-photo-of-a-statue-of-a-goddess-in-a-temple.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1' },
        '2025-09-29': { day: 7, title: 'Shubho Maha Saptami!', message: 'As the dhak beats echo, may your heart be filled with immense joy. Wishing you a vibrant start to Durga Puja celebrations!', blessing: 'Maha Saptami marks the formal beginning of Durga Puja. The Goddess is invoked into the idols, bringing her divine presence to the pandals.', image: 'https://images.pexels.com/photos/17585116/pexels-photo-17585116/free-photo-of-a-statue-of-a-god-with-many-arms.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1' },
        '2025-09-30': { day: 8, title: 'Shubho Maha Ashtami!', message: 'May the divine power of Maa Durga bless you with strength and fortitude. Wishing you a spiritually profound Maha Ashtami!', blessing: 'Maha Ashtami celebrates Maa Durga\'s victory over evil. It is the day of the powerful Sandhi Puja, a highlight of the festival.', image: 'https://images.pexels.com/photos/17585116/pexels-photo-17585116/free-photo-of-a-statue-of-a-god-with-many-arms.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1' },
        '2025-10-01': { day: 9, title: 'Shubho Maha Navami!', message: 'On this auspicious Maha Navami, may all your prayers be answered and your life be filled with prosperity and success!', blessing: 'Maha Navami is the culminating day of worship, celebrating the final victory of the Goddess. Grand aartis and rituals are performed.', image: 'https://images.pexels.com/photos/17585116/pexels-photo-17585116/free-photo-of-a-statue-of-a-god-with-many-arms.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1' },
        '2025-10-02': { day: 10, title: 'Happy Vijayadashami!', message: 'May the victory of good over evil inspire you towards a life of truth and courage. Shubho Bijoya and Happy Dussehra to you and your family!', blessing: 'Vijayadashami, or Dussehra, celebrates triumph and new beginnings. It is a day of joy, feasting, and exchanging heartfelt greetings.', image: 'https://images.pexels.com/photos/17585116/pexels-photo-17585116/free-photo-of-a-statue-of-a-god-with-many-arms.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1' }
      };
      const postDussehraDate = new Date('2025-10-02T00:00:00');
      // --- End Configuration ---
      
      const popupOverlay = document.getElementById('festive-popup-overlay');
      const popup = document.getElementById('festive-popup');
      const closeBtn = document.getElementById('close-popup-btn');
      const titleEl = document.getElementById('popup-title');
      const messageEl = document.getElementById('popup-message');
      const countdownEl = document.getElementById('countdown-timer');
      const stopwatchEl = document.getElementById('stopwatch');
      const flowersBtn = document.getElementById('generate-flowers-btn');
      const blessedBtn = document.getElementById('get-blessed-btn');
      const blessingOverlay = document.getElementById('blessing-popup-overlay');
      const blessingTitle = document.getElementById('blessing-title');
      const blessingMessage = document.getElementById('blessing-message');
      const closeBlessingBtn = document.getElementById('close-blessing-btn');

      let intervalId;

      const today = new Date();
      // Use this for testing any date: const today = new Date('2025-09-28');
      const todayString = today.getFullYear() + '-' + String(today.getMonth() + 1).padStart(2, '0') + '-' + String(today.getDate()).padStart(2, '0');
      
      const currentData = festiveData[todayString];

      function showMainPopup() {
        if (sessionStorage.getItem('festivePopupShown')) return;

        if (currentData) {
          setupPopupContent(currentData);
          popupOverlay.style.display = 'flex';
          startCountdown();
          sessionStorage.setItem('festivePopupShown', 'true');
        } else if (today >= postDussehraDate) {
          setupStopwatchPopup();
          popupOverlay.style.display = 'flex';
          startStopwatch();
          sessionStorage.setItem('festivePopupShown', 'true');
        }
      }
      
      function setupPopupContent(data) {
        titleEl.textContent = data.title;
        messageEl.textContent = data.message;
        popup.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.65), rgba(0,0,0,0.65)), url('${data.image}')`;
        blessedBtn.style.display = 'inline-flex';
        countdownEl.style.display = 'inline-block';
        stopwatchEl.style.display = 'none';
      }

      function setupStopwatchPopup() {
        titleEl.textContent = 'It will happen again next year! üå∏';
        messageEl.textContent = '‚ú® Victory of Good Over Evil, Light Over Darkness, and Love Over Hatred. May this Vijaya Dashami remind us that every ending carries the seed of a new beginning ‚Äî every goodbye, a promise of return.';
                                 
                                   
        popup.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.65), rgba(0,0,0,0.65)), url('https://i.postimg.cc/Y9CkRzsq/65155711dce8135d31068666-1695897361989.jpg')`;
        blessedBtn.style.display = 'none';
        countdownEl.style.display = 'none';
        stopwatchEl.style.display = 'inline-block';
      }

      function closeMainPopup() {
        popup.style.animation = 'zoomOut 0.4s forwards';
        setTimeout(() => {
          popupOverlay.style.display = 'none';
          popup.style.animation = 'zoomIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
        }, 400);
      }

      function startCountdown() {
        if(intervalId) clearInterval(intervalId);
        intervalId = setInterval(() => {
          const now = new Date();
          const nextDay = new Date(now);
          nextDay.setDate(now.getDate() + 1);
          nextDay.setHours(0, 0, 0, 0);
          const diff = nextDay - now;
          const h = Math.floor(diff / (1000*60*60));
          const m = Math.floor((diff % (1000*60*60)) / (1000*60));
          const s = Math.floor((diff % (1000*60)) / 1000);
          countdownEl.innerHTML = `Next day begins in: ${String(h).padStart(2,'0')}h ${String(m).padStart(2,'0')}m ${String(s).padStart(2,'0')}s`;
        }, 1000);
      }

      function startStopwatch() {
        if(intervalId) clearInterval(intervalId);
        intervalId = setInterval(() => {
          const diff = new Date() - postDussehraDate;
          const d = Math.floor(diff / (1000*60*60*24));
          const h = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
          const m = Math.floor((diff % (1000*60*60)) / (1000*60));
          const s = Math.floor((diff % (1000*60)) / 1000);
          stopwatchEl.innerHTML = `Time since Dussehra: ${d}d ${h}h ${m}m ${s}s`;
        }, 1000);
      }
      
      flowersBtn.addEventListener('click', () => {
        for (let i = 0; i < 30; i++) {
          const petal = document.createElement('div');
          petal.className = 'flower-petal';
          petal.style.left = Math.random() * 100 + 'vw';
          petal.style.animationDuration = Math.random() * 3 + 4 + 's';
          petal.style.animationDelay = Math.random() * 2 + 's';
          petal.style.backgroundColor = `hsl(${Math.random() * 60 + 300}, 100%, 70%)`;
          petal.style.transform = `rotate(${Math.random() * 360}deg)`;
          document.getElementById('festive-popup-container').appendChild(petal);
          setTimeout(() => petal.remove(), 7000);
        }
      });
      
      blessedBtn.addEventListener('click', () => {
        if (currentData) {
            blessingTitle.textContent = currentData.title;
            blessingMessage.textContent = currentData.blessing;
            blessingOverlay.style.display = 'flex';
        }
      });
      
      closeBtn.addEventListener('click', closeMainPopup);
      closeBlessingBtn.addEventListener('click', () => blessingOverlay.style.display = 'none');
      
      // Initialize the popup
      showMainPopup();
    });
  </script>
</div>

</div> </div>


  <!-- ======================= -->
<!-- Background Music Control -->
<!-- ======================= -->

<div id="bgm-popup">
  <div class="bgm-header">
    <img src="https://happysoulmusic.com/wp-content/grand-media/image/thumb/Aakash_Gandhi_free_music_download_1.webp" 
         alt="BGM Logo" class="bgm-logo">
    <span class="bgm-title">Now Playing</span>
  </div>
  <div class="bgm-controls">
    <button id="bgm-playpause">‚è∏</button>
    <button id="bgm-volup">üîä+</button>
    <button id="bgm-voldown">üîâ-</button>
  </div>
</div>

<style>
  /* Popup container */
  #bgm-popup {
    position: fixed;
    top: 15px;
    left: 15px;
    z-index: 99999;
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 12px 16px;
    border-radius: 12px;
    backdrop-filter: blur(12px);
    background: rgba(30, 30, 30, 0.55);
    color: #fff;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    font-family: Arial, sans-serif;
    user-select: none;
  }

  .bgm-header {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .bgm-logo {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
  }

  .bgm-title {
    font-size: 14px;
    font-weight: bold;
  }

  .bgm-controls {
    display: flex;
    gap: 8px;
    justify-content: center;
  }

  .bgm-controls button {
    background: rgba(255, 255, 255, 0.1);
    border: none;
    color: #fff;
    font-size: 14px;
    padding: 6px 10px;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s;
  }

  .bgm-controls button:hover {
    background: rgba(255, 255, 255, 0.25);
  }
</style>

<script>
  // Wait until bgMusic from script.js exists
  document.addEventListener("DOMContentLoaded", () => {
    const playPauseBtn = document.getElementById("bgm-playpause");
    const volUpBtn = document.getElementById("bgm-volup");
    const volDownBtn = document.getElementById("bgm-voldown");

    const updateBtn = () => {
      if (window.bgMusic && !window.bgMusic.paused) {
        playPauseBtn.textContent = "‚è∏";
      } else {
        playPauseBtn.textContent = "‚ñ∂Ô∏è";
      }
    };

    // Sync state from localStorage (for popup persistence)
    if (localStorage.getItem("bg-music-paused") === "true" && window.bgMusic) {
      window.bgMusic.pause();
    }

    updateBtn();

    playPauseBtn.addEventListener("click", () => {
      if (!window.bgMusic) return;
      if (window.bgMusic.paused) {
        window.bgMusic.play();
        localStorage.setItem("bg-music-paused", "false");
      } else {
        window.bgMusic.pause();
        localStorage.setItem("bg-music-paused", "true");
      }
      updateBtn();
    });

    volUpBtn.addEventListener("click", () => {
      if (!window.bgMusic) return;
      window.bgMusic.volume = Math.min(1, window.bgMusic.volume + 0.1);
    });

    volDownBtn.addEventListener("click", () => {
      if (!window.bgMusic) return;
      window.bgMusic.volume = Math.max(0, window.bgMusic.volume - 0.1);
    });
  });
</script>


  
  <style>
   
        /* Hide the container by default (on all screen sizes) */
    .hide-on-mobile {
      display: none;
    }

    /* Make the container visible only on larger screens */
    @media (min-width: 768px) { /* Adjust '768px' to your desired breakpoint */
      .desktop-only-container {
        display: block; /* Or grid, flex, etc., depending on your layout */
      }
    }
  </style>
  
<style>
  :root{
    --bg:#0b0f1a; --accent:#7c3aed; --muted:#9aa3b2; --card:#0f1724;
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
  }
  html,body{height:100%;margin:0;background:linear-gradient(180deg,#071026 0%, #05070b 100%);color:#e6eef8;overflow:hidden}
  #bgCanvas{position:fixed;inset:0;z-index:0}
  .app{position:relative;z-index:2;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:2rem}
  .card{width:min(1100px,96%);background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:16px;padding:22px;backdrop-filter: blur(6px);box-shadow: 0 8px 34px rgba(2,6,23,0.7);display:grid;grid-template-columns:1fr 420px;gap:18px;align-items:start}
  @media (max-width:960px){ .card{grid-template-columns:1fr; padding:16px;} .desktop-only-container{display:none} .hide-on-mobile{display:none} }
  .left{padding:6px 10%}
  .headline{font-size:clamp(36px,6vw,72px);margin:0;display:flex;gap:14px;align-items:center}
  .glitch{position:relative;color:transparent;-webkit-text-stroke:1px #fff}
  .glitch::before,.glitch::after{content:attr(data-text);position:absolute;left:0;top:0}
  .glitch::before{color:var(--accent);transform:translate(6px,-3px);opacity:.85}
  .glitch::after{color:#49f0ff;transform:translate(-6px,3px);opacity:.85}
  .sub{color:var(--muted);margin:12px 0 18px;max-width:56ch}
  .buttons{display:flex;gap:10px;flex-wrap:wrap}
  .btn{background:linear-gradient(180deg,var(--accent), #5b21b6);border:none;color:white;padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer;text-decoration:none;display:inline-flex;align-items:center;gap:8px}
  .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.05);color:var(--muted);box-shadow:none}
  .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:10px;padding:12px;min-height:320px;border:1px solid rgba(255,255,255,0.02)}
  .game-list{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .game-card{background:rgba(255,255,255,0.02);padding:10px;border-radius:8px;display:flex;flex-direction:column;gap:8px}
  .typing{height:44px;padding:10px;border-radius:10px;background:linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));display:flex;align-items:center;gap:12px;font-weight:600;color:var(--muted);overflow:hidden}
  footer{margin-top:12px;color:var(--muted);font-size:13px}
  .robot{width:96px;height:96px;border-radius:10px;background:linear-gradient(180deg,#071026,#071a36);display:flex;align-items:center;justify-content:center}
  .modal{position:fixed;inset:0;background:rgba(2,6,23,0.75);display:none;align-items:center;justify-content:center;z-index:9999;padding:18px}
  .modal.open{display:flex}
  .box{width:min(980px,96%);background:linear-gradient(180deg,#071026,#0b1330);border-radius:12px;padding:16px;border:1px solid rgba(255,255,255,0.03)}
  .game-area{display:flex;gap:14px;align-items:stretch}
  .game-canvas{flex:1;background:#05061a;border-radius:8px;padding:12px;display:flex;align-items:center;justify-content:center;min-height:360px}
  .sidebar{width:220px;background:var(--card);border-radius:8px;padding:10px;display:flex;flex-direction:column;gap:8px}
  .chip{background:rgba(255,255,255,0.02);padding:8px 10px;border-radius:8px}
  .desktop-only{display:block}
  @media (max-width:960px){ .desktop-only{display:none} }
  /* small helpers */
  button:focus{outline:2px solid rgba(124,58,237,0.2);outline-offset:3px}
  .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  label.small{font-size:13px;color:var(--muted)}
  select,input[type=range]{background:#071225;color:#e6eef8;border-radius:8px;padding:6px;border:1px solid rgba(255,255,255,0.04)}
  kbd{background:#0b1220;padding:4px 6px;border-radius:6px;font-size:12px}
</style>
</head>
<body>
<canvas id="bgCanvas" aria-hidden="true"></canvas>

<div class="app" role="main">
  <div class="card" role="article" aria-labelledby="title-404">
    <div class="left">
      <h1 id="title-404" class="headline">
        <span class="glitch" data-text="404">404</span>
        <div style="display:flex;flex-direction:column">
          <span style="font-size:18px;color:var(--muted);font-weight:700">Page not found</span>
          <span style="font-size:12px;color:var(--muted);margin-top:4px">Koi tension nahi ‚Äî thoda games, thoda fix, phir wapas.</span>
        </div>
      </h1>

      <p class="sub">URL kahin kho gaya. Ghar jao ya ek quick offline game khelo ‚Äî sab kuch localStorage pe chalega.</p>

      <div class="buttons">
        <a class="btn" href="https://www.deepdeyiitk.com" title="Home ‚Äî Deep Dey">üè† Home</a>
        <a class="btn secondary" href="https://apps.deepdeyiitk.com" title="Portfolio ‚Äî Apps">üß© Portfolio</a>
        <button class="btn" id="openGames">üéÆ Play (offline)</button>
        <a class="btn secondary" id="reportBroken" href="mailto:thedeeparise@gmail.com?subject=Broken%20Link%20404">‚úâÔ∏è Report</a>
      </div>

      <div style="margin-top:14px">
        <div class="typing" id="typingBanner" aria-live="polite">
          <span id="typingText">JEE 2027 Aspirant ‚Äî AI + Prompt Engineering Enthusiast ‚Äî Web & App Innovator ‚Äî Consistent 5AM Study Streaks</span>
          <span style="width:2px;height:18px;background:var(--accent);margin-left:8px;animation:blink 1s steps(2) infinite"></span>
        </div>
      </div>

      <footer>
        <div style="margin-top:12px">
          <div><em>Made with ‚ù§Ô∏è, AI power, and relentless focus by <b>Deep Dey</b></em></div>
        </div>
      </footer>
    </div>

    <div class="panel desktop-only-container">
      <div style="display:flex;gap:12px;align-items:center">
        <div class="robot" aria-hidden="true">
          <!-- simple robot svg -->
          <svg viewBox="0 0 64 64" width="72" height="72"><rect x="8" y="12" width="48" height="36" rx="6" fill="#071a36"/><circle cx="22" cy="28" r="4" fill="#e6eef8"/><circle cx="42" cy="28" r="4" fill="#49f0ff"/></svg>
        </div>
        <div style="flex:1">
          <h3 style="margin:0">Offline Funbox</h3>
          <p style="margin:6px 0 0;color:var(--muted);font-size:13px">Play quick games. High scores saved in your browser.</p>
        </div>
      </div>

      <!-- Fotor/graphic only on desktop -->
      <div style="margin-top:10px" class="desktop-only">
        <!-- external svg from GitHub (display only on desktop). loading=lazy -->
        <img src="https://raw.githubusercontent.com/Anuj579/Anuj579/output/github-contribution-grid-snake-dark.svg" alt="Contribution Snake" style="width:100%;border-radius:8px;margin-top:10px" loading="lazy" onerror="this.style.display='none'">
      </div>

      <div style="margin-top:10px">
        <div style="display:flex;gap:8px;margin-bottom:8px;align-items:center;justify-content:space-between">
          <small style="color:var(--muted)">Choose game & difficulty</small>
          <small style="color:var(--muted)"><kbd>G</kbd> open ‚Ä¢ <kbd>Esc</kbd> close</small>
        </div>

        <div class="game-list">
          <div class="game-card">
            <strong>Snake</strong>
            <small style="color:var(--muted)">Speed levels + custom slider. Score increases difficulty optionally.</small>
            <div class="controls">
              <label class="small">Level:
                <select id="snakeLevel">
                  <option value="easy">Easy (slow)</option>
                  <option value="normal" selected>Normal</option>
                  <option value="hard">Hard</option>
                  <option value="custom">Custom</option>
                </select>
              </label>
              <label class="small" id="snakeSliderWrap" style="display:none">Speed:
                <input id="snakeSpeed" type="range" min="3" max="18" step="1" value="8">
              </label>
            </div>
            <div style="display:flex;gap:8px;margin-top:6px">
              <button class="btn" data-game="snake">Play Snake</button>
              <button class="btn secondary" id="snakeToggleAuto">Auto-Level: Off</button>
            </div>
          </div>

          <div class="game-card">
            <strong>Tic-Tac-Toe</strong>
            <small style="color:var(--muted)">3 levels: Easy, Medium, Hard (Minimax)</small>
            <div style="margin-top:6px" class="controls">
              <label class="small">Level:
                <select id="t3Level"><option value="easy">Easy</option><option value="medium" selected>Medium</option><option value="hard">Hard</option></select>
              </label>
            </div>
            <div style="margin-top:8px"><button class="btn" data-game="t3">Play TTT</button></div>
          </div>

          <div class="game-card">
            <strong>Memory Match</strong>
            <small style="color:var(--muted)">Grid size by level. Mobile safe mode reduces hard size.</small>
            <div style="margin-top:6px" class="controls">
              <label class="small">Level:
                <select id="memLevel"><option value="easy">Easy (2√ó2)</option><option value="medium" selected>Medium (4√ó4)</option><option value="hard">Hard (6√ó6)</option></select>
              </label>
            </div>
            <div style="margin-top:8px"><button class="btn" data-game="memory">Play Memory</button></div>
          </div>

          <div class="game-card">
            <strong>Utilities</strong>
            <small style="color:var(--muted)">Download editable source</small>
            <div style="margin-top:6px"><a class="btn secondary" href="#" id="editSource">Download source</a></div>
          </div>
        </div>
      </div>

      <div style="margin-top:10px;display:flex;justify-content:space-between;align-items:center">
        <small style="color:var(--muted)">Highscores saved locally</small>
        <div style="display:flex;gap:8px">
          <div class="chip">Snake: <span id="highSnake">‚Äî</span></div>
          <div class="chip">T3 Wins: <span id="highT3">‚Äî</span></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal" id="modal" aria-hidden="true">
  <div class="box" role="dialog" aria-modal="true" aria-labelledby="gameTitle">
    <header style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
      <div><h3 id="gameTitle" style="margin:0">Game</h3><small id="gameHint" style="color:var(--muted)">controls</small></div>
      <div><button class="btn secondary" id="closeModal">Close</button></div>
    </header>

    <div class="game-area">
      <div class="game-canvas" id="gameCanvasArea"></div>
      <aside class="sidebar">
        <div class="chip" id="stat1">Score: 0</div>
        <div class="chip" id="stat2">Time: 0s</div>
        <div style="display:flex;gap:8px;margin-top:10px">
          <button class="btn" id="restartBtn">Restart</button>
          <button class="btn secondary" id="quitBtn">Quit</button>
        </div>
        <div style="margin-top:10px"><small style="color:var(--muted)">Notes: Hard memory downscales on small screens.</small></div>
      </aside>
    </div>
  </div>
</div>

<script>
/* ---------- Utilities ---------- */
const $ = (s,r=document)=>r.querySelector(s), $$=(s,r=document)=>Array.from(r.querySelectorAll(s));
const modal = $('#modal'), canvasArea = $('#gameCanvasArea');
const stat1 = $('#stat1'), stat2 = $('#stat2'), highSnake = $('#highSnake'), highT3 = $('#highT3');
const snakeLevelSel = $('#snakeLevel'), snakeSliderWrap = $('#snakeSliderWrap'), snakeSpeedRange = $('#snakeSpeed');
const t3LevelSel = $('#t3Level'), memLevelSel = $('#memLevel'), snakeAutoBtn = $('#snakeToggleAuto');

let hs_snake = parseInt(localStorage.getItem('hs_snake')||'0'), hs_t3 = parseInt(localStorage.getItem('hs_t3')||'0');
highSnake.textContent = hs_snake||'‚Äî'; highT3.textContent = hs_t3||'‚Äî';
$('#openGames').addEventListener('click', ()=> { openModal(); });

/* ---------- Background stars (lightweight) ---------- */
const bg = document.getElementById('bgCanvas'), ctx = bg.getContext('2d');
function resize(){ bg.width = innerWidth; bg.height = innerHeight; }
addEventListener('resize', resize); resize();
const stars = Array.from({length: Math.max(40, Math.floor((innerWidth*innerHeight)/70000))}).map(()=>({x:Math.random()*bg.width,y:Math.random()*bg.height,r:Math.random()*1.6+0.2,dx:(Math.random()-0.5)*0.05,dy:(Math.random()-0.5)*0.05,t:Math.random()*1000}));
(function loop(t=0){ ctx.clearRect(0,0,bg.width,bg.height); for(const s of stars){ s.x+=s.dx; s.y+=s.dy; if(s.x<0) s.x=bg.width; if(s.x>bg.width) s.x=0; if(s.y<0) s.y=bg.height; if(s.y>bg.height) s.y=0; const a=0.05+Math.abs(Math.sin((t+s.t)/600))*0.25; ctx.fillStyle = `rgba(255,255,255,${a})`; ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fill(); } requestAnimationFrame(loop); })();

/* ---------- Typing banner (simple) ---------- */
const lines = $('#typingText').textContent.split(' ‚Äî '); $('#typingText').textContent='';
let li=0, ci=0;
(function type(){
  const cur = lines[li%lines.length];
  if(ci<=cur.length){ $('#typingText').textContent = cur.slice(0,ci); ci++; setTimeout(type,25); }
  else { setTimeout(()=>{ let del = setInterval(()=>{ if(ci>=0){ $('#typingText').textContent = cur.slice(0,ci); ci--; } else { clearInterval(del); li++; ci=0; setTimeout(type,250); } },18); },1000); }
})();

/* ---------- Modal controls ---------- */
function openModal(){ modal.classList.add('open'); modal.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden'; }
function closeModal(){ modal.classList.remove('open'); modal.setAttribute('aria-hidden','true'); document.body.style.overflow=''; stopActiveGame(); }
$('#closeModal').addEventListener('click', closeModal);
$('#quitBtn').addEventListener('click', closeModal);
document.addEventListener('keydown',(e)=>{ if(e.key==='g'||e.key==='G'){ openModal(); e.preventDefault(); } if(e.key==='Escape'){ closeModal(); } });

/* ---------- Edit / Download source ---------- */
$('#editSource').addEventListener('click',(e)=>{ e.preventDefault(); const html = '<!-- editable export [Auther Copyright: Deep Dey [ @deepdey.official ~ Instagram] -->\\n'+document.documentElement.outerHTML; const blob=new Blob([html],{type:'text/html'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='404-export_by: deepdeyiitk.com.html'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url); });

/* ---------- Game routing ---------- */
let activeGame = null;
$$('[data-game]').forEach(b=> b.addEventListener('click', (ev)=> startGame(ev.currentTarget.getAttribute('data-game')) ));

function stopActiveGame(){ if(activeGame && activeGame.destroy) activeGame.destroy(); activeGame = null; canvasArea.innerHTML=''; stat1.textContent='Score: 0'; stat2.textContent='Time: 0s'; }

/* ---------- Snake with levels & auto-leveling ---------- */
let snakeAutoLevel = false;
snakeAutoBtn.addEventListener('click', ()=> { snakeAutoLevel = !snakeAutoLevel; snakeAutoBtn.textContent = 'Auto-Level: ' + (snakeAutoLevel? 'On' : 'Off'); });

snakeLevelSel.addEventListener('change', ()=> { snakeSliderWrap.style.display = snakeLevelSel.value==='custom' ? 'inline-block' : 'none'; });

// map level -> base speed (lower = slower)
function getSnakeBaseSpeed(){
  const lvl = snakeLevelSel.value;
  if(lvl==='easy') return 5;
  if(lvl==='normal') return 8;
  if(lvl==='hard') return 12;
  const val = parseInt(snakeSpeedRange.value||8); return Math.max(3, Math.min(18, val));
}

function createSnake(){
  stopActiveGame(); openModal(); $('#gameTitle').textContent='Snake'; $('#gameHint').textContent='Arrow keys / WASD to move. Eat apples. Auto-level increases speed on thresholds if enabled.';
  const canvas = document.createElement('canvas'); canvas.width=800; canvas.height=420; canvas.style.maxWidth='100%'; canvas.style.borderRadius='8px';
  canvasArea.appendChild(canvas); const c = canvas.getContext('2d');
  let tile = 18, cols = Math.floor(canvas.width/tile), rows = Math.floor(canvas.height/tile);
  let snake = [{x:Math.floor(cols/2),y:Math.floor(rows/2)}], dir={x:1,y:0}, apple=spawnApple(), score=0, running=true, baseSpeed = getSnakeBaseSpeed(), speedModifier=0, frame=0, startTime=Date.now();

  // handle responsive: reduce tiles on small screens to avoid heavy draws
  if(window.innerWidth < 600){ tile = Math.max(12, Math.floor(canvas.width/cols)); cols = Math.floor(canvas.width/tile); rows = Math.floor(canvas.height/tile); }

  function spawnApple(){ return {x:Math.floor(Math.random()*cols), y:Math.floor(Math.random()*rows)}; }
  function keydown(e){
    if(!running) return;
    const k = e.key;
    if(k==='ArrowUp' || k==='w' || k==='W'){ if(dir.y!==1) dir={x:0,y:-1}; }
    if(k==='ArrowDown' || k==='s' || k==='S'){ if(dir.y!==-1) dir={x:0,y:1}; }
    if(k==='ArrowLeft' || k==='a' || k==='A'){ if(dir.x!==1) dir={x:-1,y:0}; }
    if(k==='ArrowRight' || k==='d' || k==='D'){ if(dir.x!==-1) dir={x:1,y:0}; }
  }
  document.addEventListener('keydown', keydown);

  function loop(){
    if(!running) return;
    frame++;
    const currentBase = getSnakeBaseSpeed(); // allow dynamic change via controls
    baseSpeed = currentBase;
    // effective speed: base + dynamic modifier (auto-level increases)
    const effectiveSpeed = Math.min(20, baseSpeed + speedModifier);
    // use frames per move: higher effectiveSpeed -> fewer frames per move
    const framesPerMove = Math.max(1, Math.round(14 - effectiveSpeed)); // lower base speed => slower move
    if(frame % framesPerMove === 0){
      const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};
      if(head.x < 0) head.x = cols-1; if(head.x>=cols) head.x=0;
      if(head.y < 0) head.y = rows-1; if(head.y>=rows) head.y=0;
      if(snake.some(s=> s.x===head.x && s.y===head.y)){ endGame(); return; }
      snake.unshift(head);
      if(head.x===apple.x && head.y===apple.y){ score += 10; apple = spawnApple(); if(snakeAutoLevel){ // raise modifier every 30 points
          speedModifier = Math.min(8, Math.floor(score/30)); }
      } else snake.pop();
    }

    // render (lightweight)
    c.fillStyle = '#020217'; c.fillRect(0,0,canvas.width,canvas.height);
    // apple
    c.fillStyle = '#ff5b6e'; c.fillRect(apple.x*tile+2, apple.y*tile+2, tile-4, tile-4);
    // snake
    for(let i=0;i<snake.length;i++){
      const s=snake[i]; c.fillStyle = i===0 ? '#7c3aed' : '#6b7280'; c.fillRect(s.x*tile+1,s.y*tile+1,tile-2,tile-2);
    }
    stat1.textContent = 'Score: ' + score;
    stat2.textContent = 'Time: ' + Math.floor((Date.now()-startTime)/1000) + 's';
    requestAnimationFrame(loop);
  }

  function endGame(){
    running=false;
    document.removeEventListener('keydown', keydown);
    if(score > hs_snake){ hs_snake = score; localStorage.setItem('hs_snake', hs_snake); highSnake.textContent = hs_snake; }
    c.fillStyle='rgba(0,0,0,0.45)'; c.fillRect(0,0,canvas.width,canvas.height);
    c.fillStyle='#fff'; c.font='28px sans-serif'; c.fillText('Game Over', canvas.width/2-80, canvas.height/2-6);
    c.font='16px sans-serif'; c.fillText('Score: ' + score, canvas.width/2-46, canvas.height/2+22);
  }

  loop();

  return {
    restart(){ snake = [{x:Math.floor(cols/2),y:Math.floor(rows/2)}]; dir={x:1,y:0}; apple=spawnApple(); score=0; running=true; speedModifier=0; startTime=Date.now(); frame=0; requestAnimationFrame(loop); },
    destroy(){ document.removeEventListener('keydown', keydown); running=false; }
  };
}

/* ---------- Tic Tac Toe with levels (minimax for hard) ---------- */
function createT3(){
  stopActiveGame(); openModal(); $('#gameTitle').textContent='Tic-Tac-Toe'; $('#gameHint').textContent='You are X. CPU is O.';
  canvasArea.innerHTML='';
  const board = document.createElement('div'); board.style.display='grid'; board.style.gridTemplateColumns='repeat(3,110px)'; board.style.gap='8px'; board.style.justifyContent='center';
  canvasArea.appendChild(board);
  let cells = Array(9).fill(null), over=false;
  const cellEls = [];
  for(let i=0;i<9;i++){
    const b = document.createElement('button'); b.style.width='110px'; b.style.height='110px'; b.style.fontSize='36px'; b.style.borderRadius='8px'; b.style.background='#081026'; b.style.color='#eaf2ff';
    b.addEventListener('click', ()=> { if(over || cells[i]) return; play(i); });
    board.appendChild(b); cellEls.push(b);
  }

  function play(i){
    if(over || cells[i]) return;
    cells[i]='X'; cellEls[i].textContent='X';
    if(checkWin('X')){ finish('X'); return; }
    if(cells.every(Boolean)){ finish(null); return; }
    // CPU move depends on level
    const lvl = t3LevelSel.value;
    if(lvl==='easy'){ cpuMoveRandom(); }
    else if(lvl==='medium'){ cpuMoveMedium(); }
    else { cpuMoveHard(); }
    if(checkWin('O')){ finish('O'); return; }
    if(cells.every(Boolean)){ finish(null); return; }
  }

  function cpuMoveRandom(){ const free = cells.map((v,i)=> v?null:i).filter(v=>v!==null); const pick = free[Math.floor(Math.random()*free.length)]; cells[pick]='O'; cellEls[pick].textContent='O'; }
  function cpuMoveMedium(){
    // try win -> block -> take center -> random
    const win = findCritical('O'); if(win!==null){ cells[win]='O'; cellEls[win].textContent='O'; return; }
    const block = findCritical('X'); if(block!==null){ cells[block]='O'; cellEls[block].textContent='O'; return; }
    if(!cells[4]){ cells[4]='O'; cellEls[4].textContent='O'; return; }
    cpuMoveRandom();
  }
  function findCritical(sym){
    const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
    for(const w of wins){
      const vals = w.map(i=>cells[i]);
      if(vals.filter(v=>v===sym).length===2 && vals.includes(null)){ return w[vals.indexOf(null)]; }
    }
    return null;
  }

  // minimax for hard
  function cpuMoveHard(){
    const best = minimax(cells.slice(), 'O');
    const idx = best.index;
    if(idx!==undefined){ cells[idx]='O'; cellEls[idx].textContent='O'; }
  }
  function checkWin(sym){
    const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
    return wins.some(w=> w.every(i=> cells[i]===sym));
  }
  function finish(w){
    over=true;
    const msg = w ? (w==='X'?'You win':'CPU wins') : 'Tie';
    stat1.textContent = 'Result: ' + msg;
    if(w==='X'){ hs_t3 = (hs_t3||0)+1; localStorage.setItem('hs_t3', hs_t3); highT3.textContent = hs_t3; }
  }

  // minimax with simple pruning; scoring: O=+1, X=-1, tie=0
  function minimax(boardState, player){
    const winner = checkWinner(boardState);
    if(winner==='O') return {score:1};
    if(winner==='X') return {score:-1};
    if(boardState.every(Boolean)) return {score:0};
    const moves=[];
    for(let i=0;i<9;i++){
      if(!boardState[i]){
        const copy = boardState.slice(); copy[i]=player;
        const result = minimax(copy, player==='O' ? 'X' : 'O');
        moves.push({index:i, score: result.score});
      }
    }
    // choose best
    if(player==='O'){ // maximize
      let best = moves[0];
      for(const m of moves) if(m.score > best.score) best = m;
      return best;
    } else { // minimize
      let best = moves[0];
      for(const m of moves) if(m.score < best.score) best = m;
      return best;
    }
  }
  function checkWinner(b){
    const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
    for(const w of wins){ const [a,b1,c]=w; if(b[a] && b[a]===b[b1] && b[a]===b[c]) return b[a]; }
    return null;
  }

  return {
    restart(){ cells=Array(9).fill(null); over=false; cellEls.forEach(c=> c.textContent=''); stat1.textContent='Score: 0'; stat2.textContent='Time: 0s'; },
    destroy(){ /* nothing to remove */ }
  };
}

/* ---------- Memory Match with dynamic levels & mobile safe-mode ---------- */
function createMemory(){
  stopActiveGame(); openModal(); $('#gameTitle').textContent='Memory Match'; $('#gameHint').textContent='Flip two cards to match pairs.';
  canvasArea.innerHTML='';

  // decide grid based on level and screen
  let level = memLevelSel.value;
  let cols=4, rows=4;
  if(level==='easy'){ cols=2; rows=2; }
  else if(level==='medium'){ cols=4; rows=4; }
  else if(level==='hard'){ // on mobile downscale
    if(window.innerWidth < 600){ cols=5; rows=4; } else { cols=6; rows=6; }
  }
  const pairs = Math.floor((cols*rows)/2);
  // generate icons (simple set) sized to pairs
  const baseIcons = ['‚òÖ','‚óè','‚ñ†','‚óÜ','‚ô£','‚ô•','‚ô†','‚úø','‚òÄ','‚òæ','‚ú™','‚ú¶','‚ú∫','‚öë','‚ú∑','‚ùñ','‚úµ','‚ùÇ','‚ùÉ','‚úπ'];
  const icons = baseIcons.slice(0,pairs);
  let deck = icons.concat(icons).sort(()=>Math.random()-0.5);

  const grid = document.createElement('div'); grid.style.display='grid'; grid.style.gridTemplateColumns=`repeat(${cols},minmax(48px, 68px))`; grid.style.gap='8px'; grid.style.justifyContent='center';
  canvasArea.appendChild(grid);

  let openIdx=[], matched=0, moves=0, start=Date.now();
  const elems = [];
  deck.forEach((v,i)=>{ const b=document.createElement('button'); b.style.width='68px'; b.style.height='68px'; b.style.borderRadius='8px'; b.style.fontSize='26px'; b.style.background='#071125'; b.style.color='transparent'; b.addEventListener('click', ()=> flip(i)); grid.appendChild(b); elems.push(b); });

  function flip(i){
    if(elems[i].disabled || openIdx.includes(i)) return;
    elems[i].textContent = deck[i]; elems[i].style.color = '#fff'; openIdx.push(i);
    if(openIdx.length===2){
      moves++;
      if(deck[openIdx[0]]===deck[openIdx[1]]){
        elems[openIdx[0]].disabled=true; elems[openIdx[1]].disabled=true; matched++;
        openIdx=[];
        if(matched===pairs) end();
      } else {
        setTimeout(()=>{ openIdx.forEach(idx=> { elems[idx].textContent=''; elems[idx].style.color='transparent'; }); openIdx=[]; }, 600);
      }
    }
    stat1.textContent='Moves: '+moves;
    stat2.textContent='Time: '+Math.floor((Date.now()-start)/1000)+'s';
  }
  function end(){ const timeTaken = Math.floor((Date.now()-start)/1000); stat1.textContent='Done! Moves: '+moves; stat2.textContent='Time: '+timeTaken+'s'; }

  return {
    restart(){ deck = icons.concat(icons).sort(()=>Math.random()-0.5); matched=0; moves=0; start=Date.now(); elems.forEach(e=> { e.textContent=''; e.disabled=false; e.style.color='transparent'; }); stat1.textContent='Score: 0'; stat2.textContent='Time: 0s'; },
    destroy(){ /* nothing heavy */ }
  };
}

/* ---------- Game launcher mapping ---------- */
const constructors = { snake: createSnake, t3: createT3, memory: createMemory };
let activeCtor = null;
function startGame(name){
  if(activeGame && activeGame.destroy) activeGame.destroy();
  activeGame = constructors[name]();
}

/* wire buttons */
$$('[data-game]').forEach(b=> b.addEventListener('click', (e)=> startGame(e.currentTarget.getAttribute('data-game')) ));
$('#restartBtn').addEventListener('click', ()=> { if(activeGame && activeGame.restart) activeGame.restart(); });

/* show/hide custom slider */
snakeLevelSel.dispatchEvent(new Event('change'));

/* small accessibility focus trap (basic) */
modal.addEventListener('keydown', (e)=> { if(e.key==='Tab'){ const focusable = modal.querySelectorAll('button,a,select,input'); if(focusable.length){ const first=focusable[0], last=focusable[focusable.length-1]; if(e.shiftKey && document.activeElement===first){ last.focus(); e.preventDefault(); } else if(!e.shiftKey && document.activeElement===last){ first.focus(); e.preventDefault(); } } } });

/* console note */
console.log('Interactive 404 (levels added) ready.');
</script>

 <script>
        // Copy-paste this into your site. Change TARGET_URL to monitor another host.
        // REFRESH_MS controls realtime update frequency (ms).

        (() => {
            const TARGET_URL = window.location.origin; // <-- change if you want to monitor other URL
            const REFRESH_MS = 5000; // update every 5 seconds

            // Minimal CSS injected (Updated for bottom-center and improved mobile view)
            const style = document.createElement('style');
            style.textContent = `
            /* Button: Fixed bottom-center on all screen sizes */
            #sysBtn{
                position:fixed;
                left:50%; /* Center horizontally */
                transform:translateX(-50%); /* Adjust for own width */
                bottom:20px;
                z-index:2147483647;
                width:48px;
                height:48px;
                border-radius:50%;
                border:none;
                background:#0f172a;
                color:#fff;
                font-size:20px;
                display:none;
                align-items:center;
                justify-content:center;
                cursor:pointer;
                box-shadow:0 8px 22px rgba(2,6,23,0.4);
                transition: transform 0.2s;
            }
            #sysBtn:hover { transform: translateX(-50%) scale(1.05); }

            /* Popup: Fixed bottom-center on Desktop */
            #sysPopup{
                position:fixed;
                left:50%;
                transform:translateX(-50%);
                bottom:80px;
                width:360px;
                max-width:96vw;
                background:#fff;
                border-radius:12px;
                box-shadow:0 14px 36px rgba(2,6,23,0.18);
                z-index:2147483647;
                overflow:hidden;
                font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
            }
            #sysPopup .head{
                display:flex;
                border-bottom:1px solid #eef2f7;
                background:#f8fafc;
            }
            #sysPopup .tab{
                flex:1;
                text-align:center;
                padding:12px 6px;
                font-weight:600;
                font-size:13px;
                cursor:pointer;
                user-select:none;
                color:#475569;
                transition: background 0.1s;
            }
            #sysPopup .tab:hover { background:#f1f5f9; }
            #sysPopup .tab.active{
                background:#fff;
                color:#0f172a;
                border-bottom: 2px solid #0f172a;
            }
            #sysPopup .content{
                padding:15px;
                font-size:13px;
                line-height:1.4;
                max-height:450px;
                overflow-y:auto;
                color:#0f172a;
                -webkit-overflow-scrolling: touch;
            }
            .sys-row{
                display:flex;
                justify-content:space-between;
                margin:4px 0;
                padding:8px;
                border-radius:6px;
                background:#fbfdff;
                align-items:center;
                border: 1px solid #eef2f7;
            }
            .sys-row small{color:#6b7280}
            .est-tag{font-size:10px;color:#b91c1c;margin-left:6px;font-weight:700;padding:2px 6px;border-radius:4px;background:#fee2e2}
            .note-box{
                margin-top:12px;
                padding:12px;
                background:#f8fafc;
                border-radius:8px;
                font-size:12px;
                color:#0f172a;
                border-left: 3px solid #10b981;
            }
            
            /* Mobile adjustment: Center vertically and horizontally for better visibility */
            @media (max-width:640px){
                #sysPopup{
                    left:50%;
                    top:50%;
                    right:auto;
                    bottom:auto;
                    transform:translate(-50%,-50%);
                    width:92vw;
                    max-height:80vh; /* Limit height on small screens */
                    box-shadow:0 25px 50px -12px rgba(0, 0, 0, 0.25);
                }
                #sysPopup .content {
                    max-height: calc(80vh - 50px);
                }
                #sysBtn{
                    width:52px;
                    height:52px;
                    font-size:24px;
                }
            }
            `;
            document.head.appendChild(style);

            // Button
            const btn = document.createElement('button');
            btn.id = 'sysBtn';
            btn.title = 'System Monitor';
            btn.innerHTML = '‚ö°';
            btn.style.display = 'none';
            document.body.appendChild(btn);

            // Popup
            const popup = document.createElement('div');
            popup.id = 'sysPopup';
            popup.style.display = 'none';
            popup.innerHTML = `
                <div class="head">
                <div class="tab active" data-tab="server">Server Metrics</div>
                <div class="tab" data-tab="user">User/Browser Info</div>
                </div>
                <div class="content" id="sysContent">Initializing...</div>
            `;
            document.body.appendChild(popup);

            const $ = (s, r = popup) => r.querySelector(s);

            // Show button only when scrolled to bottom (footer area)
            function checkScrollForButton() {
                // Determine if the user is within 100px of the bottom of the page
                const nearBottom = (window.innerHeight + window.scrollY) >= (document.documentElement.scrollHeight - 100);
                btn.style.display = nearBottom ? 'flex' : 'none';
            }
            checkScrollForButton();
            window.addEventListener('scroll', checkScrollForButton);
            window.addEventListener('resize', checkScrollForButton);

            // Tabs
            popup.addEventListener('click', (e) => {
                const t = e.target.closest('.tab');
                if (!t) return;
                popup.querySelectorAll('.tab').forEach(x => x.classList.remove('active'));
                t.classList.add('active');
                updateOnce();
            });

            // Toggle
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                popup.style.display = popup.style.display === 'block' ? 'none' : 'block';
                updateOnce();
            });
            document.addEventListener('click', (e) => {
                if (popup.style.display !== 'block') return;
                if (!popup.contains(e.target) && e.target !== btn) popup.style.display = 'none';
            });

            // Measure server (ping, status, size, headers) - best effort; may be limited by CORS
            async function measureServer() {
                const start = performance.now();
                let ping = '‚Äî';
                let status = '‚Äî';
                let sizeBytes = null;
                let headersObj = {};
                try {
                    const resp = await fetch(TARGET_URL, { method: 'GET', cache: 'no-store' });
                    const end = performance.now();
                    ping = Math.round(end - start) + ' ms';
                    status = `${resp.status} ${resp.statusText}`;
                    const cl = resp.headers.get('content-length');
                    if (cl) sizeBytes = parseInt(cl, 10);
                    else {
                        // If no content-length, try to get size from blob
                        const blob = await resp.clone().blob();
                        sizeBytes = blob.size;
                    }
                    ['content-type','cache-control','last-modified','etag','server','date'].forEach(k => {
                        const v = resp.headers.get(k);
                        if (v) headersObj[k] = v;
                    });
                } catch (err) {
                    ping = 'ERR';
                    status = 'Fetch failed (CORS/network)';
                    sizeBytes = null;
                    headersObj = {};
                }
                return { ping, status, sizeBytes, headersObj };
            }

            // User info via browser APIs
            async function getUserInfo() {
                const nav = navigator;
                const conn = nav.connection || nav.mozConnection || nav.webkitConnection || null;
                let batteryInfo = null;
                try { if (navigator.getBattery) { const b = await navigator.getBattery(); batteryInfo = { level: Math.round(b.level*100)+'%', charging: b.charging }; } } catch(e){ batteryInfo=null; }
                const perf = performance;
                let mem = null;
                if (perf && perf.memory) {
                    mem = {
                        usedJSHeapSize: Math.round(perf.memory.usedJSHeapSize/1024/1024) + ' MB',
                        totalJSHeapSize: Math.round(perf.memory.totalJSHeapSize/1024/1024) + ' MB'
                    };
                }

                // cookies count
                const cookieStr = document.cookie || '';
                const cookiesCount = cookieStr ? cookieStr.split(';').length : 0;

                // time info
                const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || 'n/a';
                const localTime = new Date().toLocaleString();

                return {
                    userAgent: nav.userAgent,
                    platform: nav.platform,
                    language: nav.language,
                    cores: nav.hardwareConcurrency || 'n/a',
                    cookieEnabled: nav.cookieEnabled,
                    cookiesCount,
                    online: nav.onLine,
                    connection: conn ? { effectiveType: conn.effectiveType, downlink: conn.downlink, rtt: conn.rtt } : null,
                    battery: batteryInfo,
                    memory: mem,
                    deviceMemory: navigator.deviceMemory || 'n/a',
                    plugins: navigator.plugins ? navigator.plugins.length : 'n/a',
                    touchPoints: navigator.maxTouchPoints || 0,
                    doNotTrack: nav.doNotTrack || 'n/a',
                    viewport: { w: window.innerWidth, h: window.innerHeight },
                    timezone: tz,
                    localTime
                };
            }

            // Helpers
            function humanBytes(n) {
                if (n === null || n === undefined) return '‚Äî';
                if (typeof n !== 'number') return n;
                const sizes = ['B','KB','MB','GB','TB'];
                if (n === 0) return '0 B';
                const i = Math.floor(Math.log(n)/Math.log(1024));
                return (n/Math.pow(1024,i)).toFixed(i?2:0) + ' ' + sizes[i];
            }

            function renderServerTab(data) {
                const rows = [];
                rows.push(`<div class="sys-row"><div><small>Target URL</small></div><div><small style="max-width:180px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap">${TARGET_URL}</small></div></div>`);
                rows.push(`<div class="sys-row"><div><small>Ping Latency</small></div><div><strong>${data.ping}</strong></div></div>`);
                rows.push(`<div class="sys-row"><div><small>HTTP Status</small></div><div><strong>${data.status}</strong></div></div>`);
                rows.push(`<div class="sys-row"><div><small>Response Size</small></div><div><strong>${humanBytes(data.sizeBytes)}</strong></div></div>`);
                const hdrs = Object.keys(data.headersObj || {});
                if (hdrs.length) {
                    hdrs.forEach(k => rows.push(`<div class="sys-row"><div><small>${k}</small></div><div><small style="max-width:160px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap">${data.headersObj[k]}</small></div></div>`));
                }
                
                // Estimated (simulated) section - clearly labelled as ESTIMATED (SIMULATED)
                rows.push(`<div style="margin-top:10px;border-top:1px dashed #eef2f7;padding-top:10px;color:#374151;font-size:12px"><strong>Server Internal Metrics</strong> <span class="est-tag">SIMULATED</span></div>`);
                const estCpu = (Math.floor(Math.random()*40)+10) + '%';
                const estRam = (Math.floor(Math.random()*50)+20) + '%';
                const estDisk = (Math.floor(Math.random()*60)+15) + '%';
                rows.push(`<div class="sys-row"><div><small>CPU Load (est)</small></div><div><strong>${estCpu}</strong></div></div>`);
                rows.push(`<div class="sys-row"><div><small>RAM Usage (est)</small></div><div><strong>${estRam}</strong></div></div>`);
                rows.push(`<div class="sys-row"><div><small>Disk Usage (est)</small></div><div><strong>${estDisk}</strong></div></div>`);
                rows.push(`<div class="note-box">Note: CPU/RAM/Disk shown above are client-side random **simulations** as browsers cannot access host internals. Ping, Status, and Response size are measured live (subject to browser CORS restrictions).</div>`);
                return rows.join('');
            }

            function renderUserTab(info) {
                const r = [];
                r.push(`<div class="sys-row"><div><small>Browser/UA</small></div><div style="max-width:180px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap"><small>${info.userAgent}</small></div></div>`);
                r.push(`<div class="sys-row"><div><small>OS Platform</small></div><div><strong>${info.platform}</strong></div></div>`);
                r.push(`<div class="sys-row"><div><small>Viewport Size</small></div><div><strong>${info.viewport.w} √ó ${info.viewport.h}</strong></div></div>`);
                r.push(`<div class="sys-row"><div><small>CPU Cores</small></div><div><strong>${info.cores}</strong></div></div>`);
                r.push(`<div class="sys-row"><div><small>Device Memory</small></div><div><strong>${info.deviceMemory}</strong></div></div>`);
                r.push(`<div class="sys-row"><div><small>JS Heap (Used/Total)</small></div><div><small>${info.memory ? (info.memory.usedJSHeapSize + ' / ' + info.memory.totalJSHeapSize) : 'n/a'}</small></div></div>`);
                r.push(`<div class="sys-row"><div><small>Connection Status</small></div><div><small>${info.online ? `Online ¬∑ ${info.connection ? `${info.connection.effectiveType} ¬∑ ${info.connection.downlink}Mbps ¬∑ rtt ${info.connection.rtt}ms` : 'n/a'}` : 'Offline'}</small></div></div>`);
                r.push(`<div class="sys-row"><div><small>Timezone / Local Time</small></div><div><small>${info.timezone} ¬∑ ${info.localTime}</small></div></div>`);
                r.push(`<div class="sys-row"><div><small>Cookies</small></div><div><small>enabled:${info.cookieEnabled} ¬∑ count:${info.cookiesCount}</small></div></div>`);
                
                // Show approximate storage sizes
                try {
                    r.push(`<div class="sys-row"><div><small>localStorage Size</small></div><div><small>${(function(){ try { return humanBytes(new Blob([JSON.stringify(localStorage)]).size); } catch(e){ return 'n/a'; } })()}</small></div></div>`);
                } catch(e) {}
                try {
                    r.push(`<div class="sys-row"><div><small>sessionStorage Size</small></div><div><small>${(function(){ try { return humanBytes(new Blob([JSON.stringify(sessionStorage)]).size); } catch(e){ return 'n/a'; } })()}</small></div></div>`);
                } catch(e) {}
                
                if (info.battery) r.push(`<div class="sys-row"><div><small>Battery Status</small></div><div><small>${info.battery.level}${info.battery.charging? ' ¬∑ charging':''}</small></div></div>`);
                r.push(`<div class="note-box">Privacy Note: **No data is stored or sent anywhere.** All values shown are read locally from your browser using standard Web APIs.</div>`);
                return r.join('');
            }

            // Update logic
            async function updateOnce() {
                const active = popup.querySelector('.tab.active')?.dataset?.tab || 'server';
                const c = $('#sysContent');
                c.innerHTML = '<div style="text-align:center; padding:20px;">Loading data...</div>';
                if (active === 'server') {
                    const s = await measureServer();
                    c.innerHTML = renderServerTab(s);
                } else {
                    const u = await getUserInfo();
                    c.innerHTML = renderUserTab(u);
                }
            }

            // Auto-refresh while popup open
            setInterval(async () => {
                if (popup.style.display !== 'block') return;
                const active = popup.querySelector('.tab.active')?.dataset?.tab || 'server';
                if (active === 'server') {
                    const s = await measureServer();
                    // Only update content, no need to show 'Loading'
                    $('#sysContent').innerHTML = renderServerTab(s);
                } else {
                    const u = await getUserInfo();
                    $('#sysContent').innerHTML = renderUserTab(u);
                }
            }, REFRESH_MS);

            // Initial message
            (async () => {
                $('#sysContent').innerHTML = 'Ready ‚Äî click a tab to load real-time data.';
            })();

        })();
    </script>
  
</body>
</html>
